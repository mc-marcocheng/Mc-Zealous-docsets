<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta content="157101835696-ooapojlodmuabs2do2vuhhnf90bccmoi.apps.googleusercontent.com" name="google-signin-client-id"/>
<meta content="profile email" name="google-signin-scope"/>
<meta content="TensorFlow" property="og:site_name"/>
<meta content="website" property="og:type"/>
<meta content="#ff6f00" name="theme-color"/>
<meta charset="utf-8"/>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link crossorigin="use-credentials" href="_pwa/tensorflow/manifest.json" rel="manifest"/>
<link crossorigin="" href="/www.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.googleapis.com" rel="preconnect"/>
<link href="../../../../../../main.css" rel="stylesheet"/>

<noscript>

</noscript>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/favicon.png" rel="shortcut icon"/>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/apple-touch-icon-180x180.png" rel="apple-touch-icon"/><link href="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/Policy" rel="canonical"/><link href="https://www.tensorflow.org/s/opensearch.xml" rel="search" title="TensorFlow" type="application/opensearchdescription+xml"/>
<title>tf.keras.mixed_precision.experimental.Policy &nbsp;|&nbsp; TensorFlow Core v2.1.0</title>
<meta content="tf.keras.mixed_precision.experimental.Policy &nbsp;|&nbsp; TensorFlow Core v2.1.0" property="og:title"/>
<meta content="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/Policy" property="og:url"/>
<meta content="en" property="og:locale"/>

</head>
<body class="" layout="docs" pending="" theme="tensorflow-theme" type="reference">
<devsite-progress id="app-progress" type="indeterminate"></devsite-progress>
<section class="devsite-wrapper"> <devsite-book-nav scrollbars="">

</devsite-book-nav>
<section id="gc-wrapper">
<main class="devsite-main-content" has-book-nav="" has-toc="" role="main">
<devsite-toc class="devsite-nav"></devsite-toc>
<devsite-content>
<article class="devsite-article">
<article class="devsite-article-inner"><style>
        /* Styles inlined from /site-assets/css/style.css */
/* override theme */
table img {
  max-width: 100%;
}

/* override var element to differentiate color from comment */
var, var code, var span, .prettyprint var span {
  color: #039be5;
}

/* .devsite-terminal virtualenv prompt */
.tfo-terminal-venv::before {
  content: "(venv) $ " !important;
}

/* .devsite-terminal root prompt */
.tfo-terminal-root::before {
  content: "# " !important;
}

/* .devsite-terminal Windows prompt */
.tfo-terminal-windows::before {
  content: "C:\\> " !important;
}

/* .devsite-terminal Windows prompt w/ virtualenv */
.tfo-terminal-windows-venv::before {
  content: "(venv) C:\\> " !important;
}

.tfo-diff-green-one-level + * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green + * > * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green-list + ul > li:first-of-type {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-red-one-level + * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red + * > * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red-list + ul > li:first-of-type {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

devsite-code .tfo-notebook-code-cell-output {
  max-height: 300px;
  overflow: auto;
  background: rgba(255, 247, 237, 1);  /* orange bg to distinguish from input code cells */
}

devsite-code .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(255, 247, 237, .7);  /* orange bg to distinguish from input code cells */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output {
  background: rgba(64, 78, 103, 1);  /* medium slate */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(64, 78, 103, .7);  /* medium slate */
}

/* override default table styles for notebook buttons */
.devsite-table-wrapper .tfo-notebook-buttons {
  display: inline-block;
  margin-left: 3px;
  width: auto;
}

.tfo-notebook-buttons td {
  padding-left: 0;
  padding-right: 20px;
}

.tfo-notebook-buttons a,
.tfo-notebook-buttons :link,
.tfo-notebook-buttons :visited {
  border-radius: 8px;
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15);
  color: #202124;
  padding: 12px 24px;
  transition: box-shadow 0.2s;
}

.tfo-notebook-buttons a:hover,
.tfo-notebook-buttons a:focus {
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 2px 6px 2px rgba(60, 64, 67, .15);
}

.tfo-notebook-buttons tr {
  background: 0;
  border: 0;
}

/* on rendered notebook page,
   remove link to webpage since we're already here */
.tfo-notebook-buttons:not(.tfo-api) td:first-child {
  display: none;
}

.tfo-notebook-buttons td > a {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.tfo-notebook-buttons td > a > img {
  margin-right: 8px;
}

/* landing pages */

.tfo-landing-row-item-inset-white {
  background-color: #fff;
  padding: 32px;
}

.tfo-landing-row-item-inset-white ol,
.tfo-landing-row-item-inset-white ul {
  padding-left: 20px;
}

/* colab callout button */
.colab-callout-row devsite-code {
  border-radius: 8px 8px 0 0;
  box-shadow: none;
}

.colab-callout-footer {
  background: #e3e4e7;
  border-radius: 0 0 8px 8px;
  color: #37474f;
  padding: 20px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer {
  background: #3f4f66;
}


.colab-callout-footer > .button {
  margin-top: 4px;
  color: #ff5c00;
}

.colab-callout-footer > a > span {
  padding-top: 10px;
  vertical-align: middle;
  color: #37474f;
  padding-left: 10px;
  padding-right: 10px;
  font-size: 14px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer > a > span {
  color: #fff;
}

a.colab-button {
  background: rgba(255, 255, 255, .75);
  border: solid 1px rgba(0, 0, 0, .08);
  border-bottom-color: rgba(0, 0, 0, .15);
  border-radius: 4px;
  color: #aaa;
  display: inline-block;
  font-size: 11px !important;
  font-weight: 300;
  line-height: 16px;
  padding: 4px 8px;
  text-decoration: none;
  text-transform: uppercase;
}

a.colab-button:hover {
  background: white;
  border-color: rgba(0, 0, 0, .2);
  color: #666;
}

a.colab-button span {
  background: url(/images/colab_logo_button.svg) no-repeat 1px 1px / 20px;
  border-radius: 4px;
  display: inline-block;
  padding-left: 24px;
  text-decoration: none;
}

@media screen and (max-width: 600px) {
  .tfo-notebook-buttons td {
    display: block;
  }
}

/* guide and tutorials landing page cards and sections */

.tfo-landing-page-card {
  padding: 16px;
  box-shadow: 0 0 36px rgba(0,0,0,0.1);
  border-radius: 10px;
}

/* Page section headings */
.tfo-landing-page-heading h2, h2.tfo-landing-page-heading {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 30px;
  font-weight: 700;
  line-height: 40px;
}

/* Item title headings */
.tfo-landing-page-heading h3, h3.tfo-landing-page-heading,
.tfo-landing-page-card h3, h3.tfo-landing-page-card {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 20px;
  font-weight: 500;
  line-height: 26px;
}

/* List of tutorials notebooks for subsites */
.tfo-landing-page-resources-ul {
  padding-left: 15px
}

.tfo-landing-page-resources-ul > li {
  margin: 6px 0;
}

/* Temporary fix to hide product description in header on landing pages */
devsite-header .devsite-product-description {
  display: none;
}

        </style> <div class="devsite-banner devsite-banner-announcement">
<div class="devsite-banner-message">
<div class="devsite-banner-message-text">
            Missed TensorFlow Dev Summit? Check out the video playlist. <a class="button button-primary button-tfo-announcement" href="https://goo.gle/TFDS20AllSessions">Watch recordings</a>
</div>
</div>
</div>
<div class="devsite-article-meta">
<ul class="devsite-breadcrumb-list">
<li class="devsite-breadcrumb-item">
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1" href="">
            TensorFlow
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2" href="api">
            API
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3" href="api_docs">
            TensorFlow Core v2.1.0
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="4" href="api_docs/python/tf">
            Python
      
  </a>
</li>
</ul>
<devsite-page-rating hover-rating-star="0" position="header" selected-rating="0">
</devsite-page-rating>
</div>
<a class="dashingAutolink" name="autolink-2030"></a><a class="dashAnchor" name="//apple_ref/cpp/Function/tf.keras.mixed_precision.experimental.Policy"></a><h1 class="dash-function">tf.keras.mixed_precision.experimental.Policy</h1>
<devsite-toc class="devsite-nav" devsite-toc-embedded="">
</devsite-toc>
<div class="devsite-article-body clearfix">
<p></p>
<!-- DO NOT EDIT! Automatically generated file. -->
<div itemscope="" itemtype="http://developers.google.com/ReferenceObject">
<meta content="tf.keras.mixed_precision.experimental.Policy" itemprop="name"/>
<meta content="Stable" itemprop="path"/>
<meta content="__init__" itemprop="property"/>
<meta content="from_config" itemprop="property"/>
<meta content="get_config" itemprop="property"/>
</div>
<p><devsite-nav-buttons name="version" param="reset">
<button default="" value="stable">See Stable</button>
<button value="nightly">See Nightly</button>
</devsite-nav-buttons></p>
<!-- Stable -->
<table align="left" class="tfo-notebook-buttons tfo-api">
<tbody><tr><td>
<a href="versions/r1.15/api_docs/python/tf/keras/mixed_precision/experimental/Policy" target="_blank">
<img src="https://www.tensorflow.org/images/tf_logo_32px.png"/>
  TensorFlow 1 version</a>
</td>
<td>
<a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/keras/mixed_precision/experimental/policy.py#L40-L412" target="_blank">
<img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png"/>
    View source on GitHub
  </a>
</td></tr></tbody></table>
<p>A dtype policy for a Keras layer.</p>
<section class="expandable">
<h4 class="showalways">View aliases</h4>
<p>
<b>Compat aliases for migration</b>
</p><p>See
<a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for
more details.</p>
<p><a href="api_docs/python/tf/keras/mixed_precision/experimental/Policy"><code dir="ltr" translate="no">tf.compat.v1.keras.mixed_precision.experimental.Policy</code></a></p>
</section>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.Policy(
    name, loss_scale=USE_DEFAULT
)
</code></pre>
<h3>Used in the notebooks</h3>
<table class="vertical-rules">
<thead>
<tr>
<th>Used in the guide</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<ul>
<li><a href="https://www.tensorflow.org/guide/keras/mixed_precision">Mixed precision</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p>A dtype policy determines dtype-related aspects of a layer, such as its
computation and variable dtypes. Each layer has a policy. Policies can be
passed to the <code dir="ltr" translate="no">dtype</code> argument of layer constructors, or a global policy can
be set with <a href="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/set_policy"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.set_policy</code></a>. A layer will
default to the global policy if no policy is passed to it&#39;s constructor.</p>
<p>For many models, each layer&#39;s policy will have the same compute dtype and
variable dtype, which will typically be float32. In this case, we refer to the
singular dtype as the layer&#39;s dtype, which can be queried by the property
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer#dtype"><code dir="ltr" translate="no">tf.keras.layers.Layer.dtype</code></a>.</p>
<p>When mixed precision training is used, most layers will instead have a float16
or bfloat16 compute dtype and a float32 variable dtype, and so the layer does
not have a single dtype. See <a href="https://docs.nvidia.com/deeplearning/sdk/mixed-precision-training/index.html">this
link</a>
for more information on mixed precision training. When the variable dtype does
not match the compute dtype, variables will be automatically casted to the
compute dtype to avoid type errors. In this case,
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Layer#dtype"><code dir="ltr" translate="no">tf.keras.layers.Layer.dtype</code></a> refers to the variable dtype, not the compute
dtype.</p>
<p>Certain policies also have a <a href="https://www.tensorflow.org/api_docs/python/tf/mixed_precision/experimental/LossScale"><code dir="ltr" translate="no">tf.mixed_precision.experimental.LossScale</code></a>
instance, which is used by <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code dir="ltr" translate="no">tf.keras.Model</code></a>s to performance loss scaling. Loss
scaling is a technique used with mixed precision to avoid numerical underflow
in float16 gradients. Loss scaling is only done by Models in <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"><code dir="ltr" translate="no">Model.fit</code></a>,
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#train_on_batch"><code dir="ltr" translate="no">Model.train_on_batch</code></a>, and similar methods. Layers which are not Models
ignore the loss scale.</p>
<p>Policies are constructed by passing a string to the constructor, e.g.
<code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.Policy(&#39;float32&#39;)</code>. The string
determines the compute and variable dtypes. It can be one of the following:</p>
<ul>
<li>Any dtype name, such as &#39;float32&#39; or &#39;float64&#39;. Both the variable and
compute dtypes will be that dtype. No loss scaling is done by default.</li>
<li>&#39;mixed_float16&#39; or &#39;mixed_bfloat16&#39;: The compute dtype is float16 or
bfloat16, while the variable dtype is float32. These policies are used for
mixed precision training. With &#39;mixed_float16&#39;, a dynamic loss scale is
used by default. &#39;mixed_bfloat16&#39; does no loss scaling by default, as loss
scaling is unnecessary with bfloat16.</li>
</ul>
<h3 id="how_to_use_mixed_precision_in_a_keras_model_2">How to use mixed precision in a Keras model</h3>
<p>To use mixed precision in a Keras model, the <code dir="ltr" translate="no">&#39;mixed_float16&#39;</code> or
<code dir="ltr" translate="no">&#39;mixed_bfloat16&#39;</code> policy can be used.
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/set_policy"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.set_policy</code></a> can be used to set the
default policy for layers if no policy is passed to them. For example:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.set_policy(&#39;mixed_float16&#39;)
model = tf.keras.models.Sequential([
    tf.keras.layers.Input((100,)),
    # Dense layers use global policy of &#39;mixed_float16&#39;, which does
    # computations in float16 while keeping variables in float32.
    tf.keras.layers.Dense(10),
    tf.keras.layers.Dense(10),
    # Softmax should be done in float32 for numeric stability. We pass
    # dtype=&#39;float32&#39; to use float32 instead of the global policy.
    tf.keras.layers.Activation(&#39;softmax&#39;, dtype=&#39;float32&#39;)
])
model.compile(...)
model.fit(...)  # Train `model`
</code></pre>
<p>Alternatively, the policy can be passed to individual layers instead of
setting the global policy with <code dir="ltr" translate="no">set_policy</code>:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">policy = tf.keras.mixed_precision.experimental.Policy(&#39;mixed_float16&#39;)
model = tf.keras.models.Sequential([
    tf.keras.layers.Input((100,)),
    tf.keras.layers.Dense(10, dtype=policy),
    tf.keras.layers.Dense(10, dtype=policy),
    # Softmax should be done in float32 for numeric stability.
    tf.keras.layers.Activation(&#39;softmax&#39;, dtype=&#39;float32&#39;)
])
model.compile(...)
model.fit(...)  # Train `model`
</code></pre>
<p>Note the <code dir="ltr" translate="no">&#39;mixed_float16&#39;</code> policy will apply loss scaling by default in
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"><code dir="ltr" translate="no">Model.fit</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#train_on_batch"><code dir="ltr" translate="no">Model.train_on_batch</code></a>, and other training methods. If no such
method is used (e.g., a custom training loop is used) and <code dir="ltr" translate="no">&#39;mixed_float16&#39;</code> is
used, the loss scale must be manually applied. See
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/LossScaleOptimizer"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.LossScaleOptimizer</code></a> for details. For
<code dir="ltr" translate="no">&#39;mixed_bfloat16&#39;</code>, no loss scaling is done and loss scaling never needs to be
manually applied.</p>
<h3 id="how_to_use_float64_in_a_keras_model_2">How to use float64 in a Keras model</h3>
<p>Using float64 is similar to mixed precision. Either the global policy can be
set to float64, or <code dir="ltr" translate="no">dtype=&#39;float64&#39;</code> can be passed to individual layers. For
example, to set the global policy:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.keras.mixed_precision.experimental.set_policy(&#39;float64&#39;)
model = tf.keras.models.Sequential([
    tf.keras.layers.Input((100,)),
    # All layers use global policy of &#39;float64&#39;, which does computations and
    # creates variables in float64.
    tf.keras.layers.Dense(10),
    tf.keras.layers.Dense(10),
    tf.keras.layers.Activation(&#39;softmax&#39;)
])
model.compile(...)
model.fit(...)  # Train `model`
</code></pre>
<h3 id="how_a_layer_uses_its_policys_compute_dtype_2">How a layer uses its policy&#39;s compute dtype</h3>
<p>A layer will cast its inputs to its compute dtype in TensorFlow 2. For
example:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">x = tf.ones((4, 4, 4, 4), dtype=&#39;float64&#39;)
# `layer`&#39;s policy defaults to float32.
layer = tf.keras.layers.Conv2D(filters=4, kernel_size=2)

# `layer` casts it&#39;s inputs to its compute dtype, which is float32, and does
# computations in float32.
y = layer(x)
print(y.dtype)  # float32
</code></pre>
<p>Currently, only tensors in the first argument to the layer&#39;s <code dir="ltr" translate="no">call</code> method are
casted. For example:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">class MyLayer(tf.keras.layers.Layer):
  # Bug! `b` will not be casted.
  def call(self, a, b):
    return a + 1., b + 1.

a = tf.constant(1., dtype=&#34;float32&#34;)
b = tf.constant(1., dtype=&#34;float32&#34;)

layer = MyLayer(dtype=&#34;float64&#34;)
x, y = layer(a, b)
print(x.dtype)  # float64
print(y.dtype)  # float32. Not casted since `b` was not passed to first input
</code></pre>
<p>It is recommended to accept tensors only in the first argument. This way, all
tensors are casted to the layer&#39;s compute dtype. <code dir="ltr" translate="no">MyLayer</code> should therefore be
written as:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">class MyLayer(tf.keras.layers.Layer):
  # Now, all tensor inputs will be casted.
  def call(self, inputs):
    a, b = inputs
    return a + 1., b + 1.

a = tf.constant(1., dtype=&#34;float32&#34;)
b = tf.constant(1., dtype=&#34;float32&#34;)

layer = MyLayer(dtype=&#34;float64&#34;)
x, y = layer((a, b))
print(x.dtype)  # float64
print(y.dtype)  # float64.
</code></pre>
<p>Other arguments are not automatically casted for technical reasons, but this
may change in a future minor release.</p>
<p>A layer subclass can prevent its inputs from being autocasted by passing
<code dir="ltr" translate="no">autocast=False</code> to the layer constructor. For example:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">class NonAutoCastingLayer(tf.keras.layers.Layer):

  def __init__(self, **kwargs):
    kwargs[&#39;autocast&#39;] = False
    super(NonAutoCastingLayer, self).__init__(**kwargs)

  def call(self, inp):
    return inp

x = tf.ones((4, 4, 4, 4), dtype=&#39;float32&#39;)
layer = NonAutoCastingLayer(dtype=&#39;float64&#39;)
y = layer(x)  # MyLayer will not cast inputs to it&#39;s compute dtype of float32
print(y.dtype)  # float32
</code></pre>
<h3 id="the_deprecated_infer_policy_2">The deprecated &#34;infer&#34; policy</h3>
<p>In addition to the above mentioned policies, a policy can also be &#34;infer&#34;.
This Policy is deprecated, and it is not recommended. When a layer has an
infer policy, it will infer the computation and variable dtype from the first
input the first time the layer is called. Once the layer is called for the
first time, the layer&#39;s policy will change to the dtype of the first input.</p>
<p>In TensorFlow 1, only the &#34;infer&#34; policy is available.</p>
<h4 id="args_2">Args:</h4>
<ul>
<li><b><code dir="ltr" translate="no">name</code></b>: A string. Can be one of the following values:
<ul>
<li>Any dtype name, such as &#39;float32&#39; or &#39;float64&#39;. Both the variable and
compute dtypes will be that dtype.</li>
<li>&#39;mixed_float16&#39; or &#39;mixed_bfloat16&#39;: The compute dtype is float16 or
bfloat16, while the variable dtype is float32. With &#39;mixed_float16&#39;,
a dynamic loss scale is used. These policies are used for mixed
precision training.</li>
<li>&#39;infer&#39; (deprecated): Infer the compute and variable dtype from the
input dtype.</li>
</ul></li>
<li><b><code dir="ltr" translate="no">loss_scale</code></b>: A <a href="https://www.tensorflow.org/api_docs/python/tf/mixed_precision/experimental/LossScale"><code dir="ltr" translate="no">tf.mixed_precision.experimental.LossScale</code></a>, an int (which
uses a <code dir="ltr" translate="no">FixedLossScale</code>), or the string &#34;dynamic&#34; (which uses a
<code dir="ltr" translate="no">DynamicLossScale</code>). Defaults to using no loss scaling unless <code dir="ltr" translate="no">name</code> is
&#34;mixed_float16&#34;, in which case this defaults to &#34;dynamic&#34;. Only
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model"><code dir="ltr" translate="no">tf.keras.Model</code></a>s, not layers, use the loss scale, and it is only used
during <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#fit"><code dir="ltr" translate="no">Model.fit</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/keras/Model#train_on_batch"><code dir="ltr" translate="no">Model.train_on_batch</code></a>, and other similar methods.</li>
</ul>
<h4 id="attributes_2">Attributes:</h4>
<ul>
<li><p><b><code dir="ltr" translate="no">compute_dtype</code></b>:   The compute dtype of this policy.</p>
<p>This is the dtype layers will do their computations in.</p>
<p>Note that even if the compute dtype is float16 or bfloat16, hardware devices
may not do individual adds, multiplies, and other fundamental operations in
[b]float16, but instead may do some of them in float32 for numeric
stability. The compute dtype is the dtype of the inputs and outputs of the
TensorFlow ops that the layer executes. Internally, many TensorFlow ops will
do certain internal calculations in float32, or some other device-internal
intermediate format with higher precision than [b]float16, to increase
numeric stability.</p>
<p>For example, a <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense"><code dir="ltr" translate="no">tf.keras.layers.Dense</code></a> layer, when run on a GPU with a
float16 compute dtype, will pass float16 inputs to tf.matmul. But, tf.matmul
will do use float32 intermediate math. The performance benefit of float16 is
still apparent, due to increased memory bandwidth and the fact modern GPUs
have specialized hardware for computing matmuls on float16 while still
keeping intermediate computations in float32.</p></li>
<li><p><b><code dir="ltr" translate="no">loss_scale</code></b>:   Returns the loss scale of this Policy.</p></li>
<li><p><b><code dir="ltr" translate="no">name</code></b>:   Returns the name of this policy.</p></li>
<li><p><b><code dir="ltr" translate="no">should_cast_variables</code></b>:   Returns True if variables should be casted.</p>
<p>This is true if the variable dtype is not the same as the compute dtype.</p></li>
<li><p><b><code dir="ltr" translate="no">variable_dtype</code></b>:   The variable dtype of this policy.</p>
<p>This is the dtype layers will create their variables in, unless a layer
explicitly chooses a different dtype. If this is different than
<a href="https://www.tensorflow.org/api_docs/python/tf/keras/mixed_precision/experimental/Policy#compute_dtype"><code dir="ltr" translate="no">Policy.compute_dtype</code></a>, Layers will cast variables to the compute dtype to
avoid type errors.</p></li>
</ul>
<h2 id="methods_2">Methods</h2>
<h3 id="from_config"><code dir="ltr" translate="no">from_config</code></h3>
<p><a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/keras/mixed_precision/experimental/policy.py#L406-L412" target="_blank">View source</a></p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">@classmethod
from_config(
    cls, config, custom_objects=None
)
</code></pre>
<h3 id="get_config"><code dir="ltr" translate="no">get_config</code></h3>
<p><a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/keras/mixed_precision/experimental/policy.py#L395-L404" target="_blank">View source</a></p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">get_config()
</code></pre>
</div>
<devsite-page-rating hover-rating-star="0" position="footer" selected-rating="0">
</devsite-page-rating>
</article>
</article>

</devsite-content>
</main>
<devsite-footer-promos class="devsite-footer">
</devsite-footer-promos>
<devsite-footer-linkboxes class="devsite-footer">

</devsite-footer-linkboxes>
<devsite-footer-utility class="devsite-footer">
<div class="devsite-footer-utility nocontent">

</div>
</devsite-footer-utility>
</section></section>
<devsite-sitemask></devsite-sitemask>
<devsite-snackbar></devsite-snackbar> <devsite-tooltip></devsite-tooltip>
<devsite-heading-link></devsite-heading-link>
<devsite-analytics>


</devsite-analytics>
 
</body></html>