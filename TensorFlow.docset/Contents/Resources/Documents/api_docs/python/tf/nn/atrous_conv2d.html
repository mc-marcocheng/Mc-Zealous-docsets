<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta content="157101835696-ooapojlodmuabs2do2vuhhnf90bccmoi.apps.googleusercontent.com" name="google-signin-client-id"/>
<meta content="profile email" name="google-signin-scope"/>
<meta content="TensorFlow" property="og:site_name"/>
<meta content="website" property="og:type"/>
<meta content="#ff6f00" name="theme-color"/>
<meta charset="utf-8"/>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link crossorigin="use-credentials" href="_pwa/tensorflow/manifest.json" rel="manifest"/>
<link crossorigin="" href="/www.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.googleapis.com" rel="preconnect"/>
<link href="../../../../main.css" rel="stylesheet"/>

<noscript>

</noscript>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/favicon.png" rel="shortcut icon"/>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/apple-touch-icon-180x180.png" rel="apple-touch-icon"/><link href="https://www.tensorflow.org/api_docs/python/tf/nn/atrous_conv2d" rel="canonical"/><link href="https://www.tensorflow.org/s/opensearch.xml" rel="search" title="TensorFlow" type="application/opensearchdescription+xml"/>
<title>tf.nn.atrous_conv2d &nbsp;|&nbsp; TensorFlow Core v2.1.0</title>
<meta content="tf.nn.atrous_conv2d &nbsp;|&nbsp; TensorFlow Core v2.1.0" property="og:title"/>
<meta content="https://www.tensorflow.org/api_docs/python/tf/nn/atrous_conv2d" property="og:url"/>
<meta content="en" property="og:locale"/>

</head>
<body class="" layout="docs" pending="" theme="tensorflow-theme" type="reference">
<devsite-progress id="app-progress" type="indeterminate"></devsite-progress>
<section class="devsite-wrapper"> <devsite-book-nav scrollbars="">

</devsite-book-nav>
<section id="gc-wrapper">
<main class="devsite-main-content" has-book-nav="" has-toc="" role="main">
<devsite-toc class="devsite-nav"></devsite-toc>
<devsite-content>
<article class="devsite-article">
<article class="devsite-article-inner"><style>
        /* Styles inlined from /site-assets/css/style.css */
/* override theme */
table img {
  max-width: 100%;
}

/* override var element to differentiate color from comment */
var, var code, var span, .prettyprint var span {
  color: #039be5;
}

/* .devsite-terminal virtualenv prompt */
.tfo-terminal-venv::before {
  content: "(venv) $ " !important;
}

/* .devsite-terminal root prompt */
.tfo-terminal-root::before {
  content: "# " !important;
}

/* .devsite-terminal Windows prompt */
.tfo-terminal-windows::before {
  content: "C:\\> " !important;
}

/* .devsite-terminal Windows prompt w/ virtualenv */
.tfo-terminal-windows-venv::before {
  content: "(venv) C:\\> " !important;
}

.tfo-diff-green-one-level + * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green + * > * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green-list + ul > li:first-of-type {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-red-one-level + * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red + * > * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red-list + ul > li:first-of-type {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

devsite-code .tfo-notebook-code-cell-output {
  max-height: 300px;
  overflow: auto;
  background: rgba(255, 247, 237, 1);  /* orange bg to distinguish from input code cells */
}

devsite-code .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(255, 247, 237, .7);  /* orange bg to distinguish from input code cells */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output {
  background: rgba(64, 78, 103, 1);  /* medium slate */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(64, 78, 103, .7);  /* medium slate */
}

/* override default table styles for notebook buttons */
.devsite-table-wrapper .tfo-notebook-buttons {
  display: inline-block;
  margin-left: 3px;
  width: auto;
}

.tfo-notebook-buttons td {
  padding-left: 0;
  padding-right: 20px;
}

.tfo-notebook-buttons a,
.tfo-notebook-buttons :link,
.tfo-notebook-buttons :visited {
  border-radius: 8px;
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15);
  color: #202124;
  padding: 12px 24px;
  transition: box-shadow 0.2s;
}

.tfo-notebook-buttons a:hover,
.tfo-notebook-buttons a:focus {
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 2px 6px 2px rgba(60, 64, 67, .15);
}

.tfo-notebook-buttons tr {
  background: 0;
  border: 0;
}

/* on rendered notebook page,
   remove link to webpage since we're already here */
.tfo-notebook-buttons:not(.tfo-api) td:first-child {
  display: none;
}

.tfo-notebook-buttons td > a {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.tfo-notebook-buttons td > a > img {
  margin-right: 8px;
}

/* landing pages */

.tfo-landing-row-item-inset-white {
  background-color: #fff;
  padding: 32px;
}

.tfo-landing-row-item-inset-white ol,
.tfo-landing-row-item-inset-white ul {
  padding-left: 20px;
}

/* colab callout button */
.colab-callout-row devsite-code {
  border-radius: 8px 8px 0 0;
  box-shadow: none;
}

.colab-callout-footer {
  background: #e3e4e7;
  border-radius: 0 0 8px 8px;
  color: #37474f;
  padding: 20px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer {
  background: #3f4f66;
}


.colab-callout-footer > .button {
  margin-top: 4px;
  color: #ff5c00;
}

.colab-callout-footer > a > span {
  padding-top: 10px;
  vertical-align: middle;
  color: #37474f;
  padding-left: 10px;
  padding-right: 10px;
  font-size: 14px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer > a > span {
  color: #fff;
}

a.colab-button {
  background: rgba(255, 255, 255, .75);
  border: solid 1px rgba(0, 0, 0, .08);
  border-bottom-color: rgba(0, 0, 0, .15);
  border-radius: 4px;
  color: #aaa;
  display: inline-block;
  font-size: 11px !important;
  font-weight: 300;
  line-height: 16px;
  padding: 4px 8px;
  text-decoration: none;
  text-transform: uppercase;
}

a.colab-button:hover {
  background: white;
  border-color: rgba(0, 0, 0, .2);
  color: #666;
}

a.colab-button span {
  background: url(/images/colab_logo_button.svg) no-repeat 1px 1px / 20px;
  border-radius: 4px;
  display: inline-block;
  padding-left: 24px;
  text-decoration: none;
}

@media screen and (max-width: 600px) {
  .tfo-notebook-buttons td {
    display: block;
  }
}

/* guide and tutorials landing page cards and sections */

.tfo-landing-page-card {
  padding: 16px;
  box-shadow: 0 0 36px rgba(0,0,0,0.1);
  border-radius: 10px;
}

/* Page section headings */
.tfo-landing-page-heading h2, h2.tfo-landing-page-heading {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 30px;
  font-weight: 700;
  line-height: 40px;
}

/* Item title headings */
.tfo-landing-page-heading h3, h3.tfo-landing-page-heading,
.tfo-landing-page-card h3, h3.tfo-landing-page-card {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 20px;
  font-weight: 500;
  line-height: 26px;
}

/* List of tutorials notebooks for subsites */
.tfo-landing-page-resources-ul {
  padding-left: 15px
}

.tfo-landing-page-resources-ul > li {
  margin: 6px 0;
}

/* Temporary fix to hide product description in header on landing pages */
devsite-header .devsite-product-description {
  display: none;
}

        </style> <div class="devsite-banner devsite-banner-announcement">
<div class="devsite-banner-message">
<div class="devsite-banner-message-text">
            Missed TensorFlow Dev Summit? Check out the video playlist. <a class="button button-primary button-tfo-announcement" href="https://goo.gle/TFDS20AllSessions">Watch recordings</a>
</div>
</div>
</div>
<div class="devsite-article-meta">
<ul class="devsite-breadcrumb-list">
<li class="devsite-breadcrumb-item">
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1" href="">
            TensorFlow
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2" href="api">
            API
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3" href="api_docs">
            TensorFlow Core v2.1.0
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="4" href="api_docs/python/tf">
            Python
      
  </a>
</li>
</ul>
<devsite-page-rating hover-rating-star="0" position="header" selected-rating="0">
</devsite-page-rating>
</div>
<a class="dashingAutolink" name="autolink-2372"></a><a class="dashAnchor" name="//apple_ref/cpp/Function/tf.nn.atrous_conv2d"></a><h1 class="dash-function">tf.nn.atrous_conv2d</h1>
<devsite-toc class="devsite-nav" devsite-toc-embedded="">
</devsite-toc>
<div class="devsite-article-body clearfix">
<p></p>
<!-- DO NOT EDIT! Automatically generated file. -->
<div itemscope="" itemtype="http://developers.google.com/ReferenceObject">
<meta content="tf.nn.atrous_conv2d" itemprop="name"/>
<meta content="Stable" itemprop="path"/>
</div>
<p><devsite-nav-buttons name="version" param="reset">
<button default="" value="stable">See Stable</button>
<button value="nightly">See Nightly</button>
</devsite-nav-buttons></p>
<!-- Stable -->
<table align="left" class="tfo-notebook-buttons tfo-api">
<tbody><tr><td>
<a href="versions/r1.15/api_docs/python/tf/nn/atrous_conv2d" target="_blank">
<img src="https://www.tensorflow.org/images/tf_logo_32px.png"/>
  TensorFlow 1 version</a>
</td>
<td>
<a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/ops/nn_ops.py#L1413-L1547" target="_blank">
<img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png"/>
    View source on GitHub
  </a>
</td></tr></tbody></table>
<p>Atrous convolution (a.k.a. convolution with holes or dilated convolution).</p>
<section class="expandable">
<h4 class="showalways">View aliases</h4>
<p>
<b>Compat aliases for migration</b>
</p><p>See
<a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for
more details.</p>
<p><a href="api_docs/python/tf/nn/atrous_conv2d"><code dir="ltr" translate="no">tf.compat.v1.nn.atrous_conv2d</code></a></p>
</section>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.nn.atrous_conv2d(
    value, filters, rate, padding, name=None
)
</code></pre>
<!-- Placeholder for "Used in" -->
<p>This function is a simpler wrapper around the more general
<a href="https://www.tensorflow.org/api_docs/python/tf/nn/convolution"><code dir="ltr" translate="no">tf.nn.convolution</code></a>, and exists only for backwards compatibility. You can
use <a href="https://www.tensorflow.org/api_docs/python/tf/nn/convolution"><code dir="ltr" translate="no">tf.nn.convolution</code></a> to perform 1-D, 2-D, or 3-D atrous convolution.</p>
<p>Computes a 2-D atrous convolution, also known as convolution with holes or
dilated convolution, given 4-D <code dir="ltr" translate="no">value</code> and <code dir="ltr" translate="no">filters</code> tensors. If the <code dir="ltr" translate="no">rate</code>
parameter is equal to one, it performs regular 2-D convolution. If the <code dir="ltr" translate="no">rate</code>
parameter is greater than one, it performs convolution with holes, sampling
the input values every <code dir="ltr" translate="no">rate</code> pixels in the <code dir="ltr" translate="no">height</code> and <code dir="ltr" translate="no">width</code> dimensions.
This is equivalent to convolving the input with a set of upsampled filters,
produced by inserting <code dir="ltr" translate="no">rate - 1</code> zeros between two consecutive values of the
filters along the <code dir="ltr" translate="no">height</code> and <code dir="ltr" translate="no">width</code> dimensions, hence the name atrous
convolution or convolution with holes (the French word trous means holes in
English).</p>
<h4 id="more_specifically_2">More specifically:</h4>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">output[batch, height, width, out_channel] =
    sum_{dheight, dwidth, in_channel} (
        filters[dheight, dwidth, in_channel, out_channel] *
        value[batch, height + rate*dheight, width + rate*dwidth, in_channel]
    )
</code></pre>
<p>Atrous convolution allows us to explicitly control how densely to compute
feature responses in fully convolutional networks. Used in conjunction with
bilinear interpolation, it offers an alternative to <code dir="ltr" translate="no">conv2d_transpose</code> in
dense prediction tasks such as semantic image segmentation, optical flow
computation, or depth estimation. It also allows us to effectively enlarge
the field of view of filters without increasing the number of parameters or
the amount of computation.</p>
<p>For a description of atrous convolution and how it can be used for dense
feature extraction, please see: <a href="http://arxiv.org/abs/1412.7062">Semantic Image Segmentation with Deep
Convolutional Nets and Fully Connected CRFs</a>.
The same operation is investigated further in <a href="http://arxiv.org/abs/1511.07122">Multi-Scale Context Aggregation
by Dilated Convolutions</a>. Previous works
that effectively use atrous convolution in different ways are, among others,
<a href="http://arxiv.org/abs/1312.6229">OverFeat: Integrated Recognition, Localization and Detection using
Convolutional Networks</a> and <a href="http://arxiv.org/abs/1302.1700">Fast Image
Scanning with Deep Max-Pooling Convolutional Neural
Networks</a>.
Atrous convolution is also closely related to the so-called noble identities
in multi-rate signal processing.</p>
<p>There are many different ways to implement atrous convolution (see the refs
above). The implementation here reduces</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">    atrous_conv2d(value, filters, rate, padding=padding)
</code></pre>
<p>to the following three operations:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">    paddings = ...
    net = space_to_batch(value, paddings, block_size=rate)
    net = conv2d(net, filters, strides=[1, 1, 1, 1], padding=&#34;VALID&#34;)
    crops = ...
    net = batch_to_space(net, crops, block_size=rate)
</code></pre>
<p>Advanced usage. Note the following optimization: A sequence of <code dir="ltr" translate="no">atrous_conv2d</code>
operations with identical <code dir="ltr" translate="no">rate</code> parameters, &#39;SAME&#39; <code dir="ltr" translate="no">padding</code>, and filters
with odd heights/ widths:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">    net = atrous_conv2d(net, filters1, rate, padding=&#34;SAME&#34;)
    net = atrous_conv2d(net, filters2, rate, padding=&#34;SAME&#34;)
    ...
    net = atrous_conv2d(net, filtersK, rate, padding=&#34;SAME&#34;)
</code></pre>
<p>can be equivalently performed cheaper in terms of computation and memory as:</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">    pad = ...  # padding so that the input dims are multiples of rate
    net = space_to_batch(net, paddings=pad, block_size=rate)
    net = conv2d(net, filters1, strides=[1, 1, 1, 1], padding=&#34;SAME&#34;)
    net = conv2d(net, filters2, strides=[1, 1, 1, 1], padding=&#34;SAME&#34;)
    ...
    net = conv2d(net, filtersK, strides=[1, 1, 1, 1], padding=&#34;SAME&#34;)
    net = batch_to_space(net, crops=pad, block_size=rate)
</code></pre>
<p>because a pair of consecutive <code dir="ltr" translate="no">space_to_batch</code> and <code dir="ltr" translate="no">batch_to_space</code> ops with
the same <code dir="ltr" translate="no">block_size</code> cancel out when their respective <code dir="ltr" translate="no">paddings</code> and <code dir="ltr" translate="no">crops</code>
inputs are identical.</p>
<h4 id="args_2">Args:</h4>
<ul>
<li><b><code dir="ltr" translate="no">value</code></b>: A 4-D <code dir="ltr" translate="no">Tensor</code> of type <code dir="ltr" translate="no">float</code>. It needs to be in the default &#34;NHWC&#34;
format. Its shape is <code dir="ltr" translate="no">[batch, in_height, in_width, in_channels]</code>.</li>
<li><b><code dir="ltr" translate="no">filters</code></b>: A 4-D <code dir="ltr" translate="no">Tensor</code> with the same type as <code dir="ltr" translate="no">value</code> and shape
<code dir="ltr" translate="no">[filter_height, filter_width, in_channels, out_channels]</code>. <code dir="ltr" translate="no">filters</code>&#39;
<code dir="ltr" translate="no">in_channels</code> dimension must match that of <code dir="ltr" translate="no">value</code>. Atrous convolution is
equivalent to standard convolution with upsampled filters with effective
height <code dir="ltr" translate="no">filter_height + (filter_height - 1) * (rate - 1)</code> and effective
width <code dir="ltr" translate="no">filter_width + (filter_width - 1) * (rate - 1)</code>, produced by
inserting <code dir="ltr" translate="no">rate - 1</code> zeros along consecutive elements across the
<code dir="ltr" translate="no">filters</code>&#39; spatial dimensions.</li>
<li><b><code dir="ltr" translate="no">rate</code></b>: A positive int32. The stride with which we sample input values across
the <code dir="ltr" translate="no">height</code> and <code dir="ltr" translate="no">width</code> dimensions. Equivalently, the rate by which we
upsample the filter values by inserting zeros across the <code dir="ltr" translate="no">height</code> and
<code dir="ltr" translate="no">width</code> dimensions. In the literature, the same parameter is sometimes
called <code dir="ltr" translate="no">input stride</code> or <code dir="ltr" translate="no">dilation</code>.</li>
<li><b><code dir="ltr" translate="no">padding</code></b>: A string, either <code dir="ltr" translate="no">&#39;VALID&#39;</code> or <code dir="ltr" translate="no">&#39;SAME&#39;</code>. The padding algorithm.</li>
<li><b><code dir="ltr" translate="no">name</code></b>: Optional name for the returned tensor.</li>
</ul>
<h4 id="returns_2">Returns:</h4>
<p>A <code dir="ltr" translate="no">Tensor</code> with the same type as <code dir="ltr" translate="no">value</code>.
Output shape with <code dir="ltr" translate="no">&#39;VALID&#39;</code> padding is:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">[batch, height - 2 * (filter_width - 1),
 width - 2 * (filter_height - 1), out_channels].
</code></pre>
<p>Output shape with <code dir="ltr" translate="no">&#39;SAME&#39;</code> padding is:</p>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">[batch, height, width, out_channels].
</code></pre>
<h4 id="raises_2">Raises:</h4>
<ul>
<li><b><code dir="ltr" translate="no">ValueError</code></b>: If input/output depth does not match <code dir="ltr" translate="no">filters</code>&#39; shape, or if
padding is other than <code dir="ltr" translate="no">&#39;VALID&#39;</code> or <code dir="ltr" translate="no">&#39;SAME&#39;</code>.</li>
</ul>
</div>
<devsite-page-rating hover-rating-star="0" position="footer" selected-rating="0">
</devsite-page-rating>
</article>
</article>

</devsite-content>
</main>
<devsite-footer-promos class="devsite-footer">
</devsite-footer-promos>
<devsite-footer-linkboxes class="devsite-footer">

</devsite-footer-linkboxes>
<devsite-footer-utility class="devsite-footer">
<div class="devsite-footer-utility nocontent">

</div>
</devsite-footer-utility>
</section></section>
<devsite-sitemask></devsite-sitemask>
<devsite-snackbar></devsite-snackbar> <devsite-tooltip></devsite-tooltip>
<devsite-heading-link></devsite-heading-link>
<devsite-analytics>


</devsite-analytics>
 
</body></html>