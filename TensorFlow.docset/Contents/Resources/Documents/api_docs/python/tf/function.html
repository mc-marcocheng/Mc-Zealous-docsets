<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta content="157101835696-ooapojlodmuabs2do2vuhhnf90bccmoi.apps.googleusercontent.com" name="google-signin-client-id"/>
<meta content="profile email" name="google-signin-scope"/>
<meta content="TensorFlow" property="og:site_name"/>
<meta content="website" property="og:type"/>
<meta content="#ff6f00" name="theme-color"/>
<meta charset="utf-8"/>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link crossorigin="use-credentials" href="_pwa/tensorflow/manifest.json" rel="manifest"/>
<link crossorigin="" href="/www.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.googleapis.com" rel="preconnect"/>
<link href="../../../main.css" rel="stylesheet"/>

<noscript>

</noscript>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/favicon.png" rel="shortcut icon"/>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/apple-touch-icon-180x180.png" rel="apple-touch-icon"/><link href="https://www.tensorflow.org/api_docs/python/tf/function" rel="canonical"/><link href="https://www.tensorflow.org/s/opensearch.xml" rel="search" title="TensorFlow" type="application/opensearchdescription+xml"/>
<title>tf.function &nbsp;|&nbsp; TensorFlow Core v2.1.0</title>
<meta content="tf.function &nbsp;|&nbsp; TensorFlow Core v2.1.0" property="og:title"/>
<meta content="https://www.tensorflow.org/api_docs/python/tf/function" property="og:url"/>
<meta content="en" property="og:locale"/>

</head>
<body class="" layout="docs" pending="" theme="tensorflow-theme" type="reference">
<devsite-progress id="app-progress" type="indeterminate"></devsite-progress>
<section class="devsite-wrapper"> <devsite-book-nav scrollbars="">

</devsite-book-nav>
<section id="gc-wrapper">
<main class="devsite-main-content" has-book-nav="" has-toc="" role="main">
<devsite-toc class="devsite-nav"></devsite-toc>
<devsite-content>
<article class="devsite-article">
<article class="devsite-article-inner"><style>
        /* Styles inlined from /site-assets/css/style.css */
/* override theme */
table img {
  max-width: 100%;
}

/* override var element to differentiate color from comment */
var, var code, var span, .prettyprint var span {
  color: #039be5;
}

/* .devsite-terminal virtualenv prompt */
.tfo-terminal-venv::before {
  content: "(venv) $ " !important;
}

/* .devsite-terminal root prompt */
.tfo-terminal-root::before {
  content: "# " !important;
}

/* .devsite-terminal Windows prompt */
.tfo-terminal-windows::before {
  content: "C:\\> " !important;
}

/* .devsite-terminal Windows prompt w/ virtualenv */
.tfo-terminal-windows-venv::before {
  content: "(venv) C:\\> " !important;
}

.tfo-diff-green-one-level + * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green + * > * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green-list + ul > li:first-of-type {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-red-one-level + * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red + * > * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red-list + ul > li:first-of-type {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

devsite-code .tfo-notebook-code-cell-output {
  max-height: 300px;
  overflow: auto;
  background: rgba(255, 247, 237, 1);  /* orange bg to distinguish from input code cells */
}

devsite-code .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(255, 247, 237, .7);  /* orange bg to distinguish from input code cells */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output {
  background: rgba(64, 78, 103, 1);  /* medium slate */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(64, 78, 103, .7);  /* medium slate */
}

/* override default table styles for notebook buttons */
.devsite-table-wrapper .tfo-notebook-buttons {
  display: inline-block;
  margin-left: 3px;
  width: auto;
}

.tfo-notebook-buttons td {
  padding-left: 0;
  padding-right: 20px;
}

.tfo-notebook-buttons a,
.tfo-notebook-buttons :link,
.tfo-notebook-buttons :visited {
  border-radius: 8px;
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15);
  color: #202124;
  padding: 12px 24px;
  transition: box-shadow 0.2s;
}

.tfo-notebook-buttons a:hover,
.tfo-notebook-buttons a:focus {
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 2px 6px 2px rgba(60, 64, 67, .15);
}

.tfo-notebook-buttons tr {
  background: 0;
  border: 0;
}

/* on rendered notebook page,
   remove link to webpage since we're already here */
.tfo-notebook-buttons:not(.tfo-api) td:first-child {
  display: none;
}

.tfo-notebook-buttons td > a {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.tfo-notebook-buttons td > a > img {
  margin-right: 8px;
}

/* landing pages */

.tfo-landing-row-item-inset-white {
  background-color: #fff;
  padding: 32px;
}

.tfo-landing-row-item-inset-white ol,
.tfo-landing-row-item-inset-white ul {
  padding-left: 20px;
}

/* colab callout button */
.colab-callout-row devsite-code {
  border-radius: 8px 8px 0 0;
  box-shadow: none;
}

.colab-callout-footer {
  background: #e3e4e7;
  border-radius: 0 0 8px 8px;
  color: #37474f;
  padding: 20px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer {
  background: #3f4f66;
}


.colab-callout-footer > .button {
  margin-top: 4px;
  color: #ff5c00;
}

.colab-callout-footer > a > span {
  padding-top: 10px;
  vertical-align: middle;
  color: #37474f;
  padding-left: 10px;
  padding-right: 10px;
  font-size: 14px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer > a > span {
  color: #fff;
}

a.colab-button {
  background: rgba(255, 255, 255, .75);
  border: solid 1px rgba(0, 0, 0, .08);
  border-bottom-color: rgba(0, 0, 0, .15);
  border-radius: 4px;
  color: #aaa;
  display: inline-block;
  font-size: 11px !important;
  font-weight: 300;
  line-height: 16px;
  padding: 4px 8px;
  text-decoration: none;
  text-transform: uppercase;
}

a.colab-button:hover {
  background: white;
  border-color: rgba(0, 0, 0, .2);
  color: #666;
}

a.colab-button span {
  background: url(/images/colab_logo_button.svg) no-repeat 1px 1px / 20px;
  border-radius: 4px;
  display: inline-block;
  padding-left: 24px;
  text-decoration: none;
}

@media screen and (max-width: 600px) {
  .tfo-notebook-buttons td {
    display: block;
  }
}

/* guide and tutorials landing page cards and sections */

.tfo-landing-page-card {
  padding: 16px;
  box-shadow: 0 0 36px rgba(0,0,0,0.1);
  border-radius: 10px;
}

/* Page section headings */
.tfo-landing-page-heading h2, h2.tfo-landing-page-heading {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 30px;
  font-weight: 700;
  line-height: 40px;
}

/* Item title headings */
.tfo-landing-page-heading h3, h3.tfo-landing-page-heading,
.tfo-landing-page-card h3, h3.tfo-landing-page-card {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 20px;
  font-weight: 500;
  line-height: 26px;
}

/* List of tutorials notebooks for subsites */
.tfo-landing-page-resources-ul {
  padding-left: 15px
}

.tfo-landing-page-resources-ul > li {
  margin: 6px 0;
}

/* Temporary fix to hide product description in header on landing pages */
devsite-header .devsite-product-description {
  display: none;
}

        </style> <div class="devsite-banner devsite-banner-announcement">
<div class="devsite-banner-message">
<div class="devsite-banner-message-text">
            Missed TensorFlow Dev Summit? Check out the video playlist. <a class="button button-primary button-tfo-announcement" href="https://goo.gle/TFDS20AllSessions">Watch recordings</a>
</div>
</div>
</div>
<div class="devsite-article-meta">
<ul class="devsite-breadcrumb-list">
<li class="devsite-breadcrumb-item">
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1" href="">
            TensorFlow
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2" href="api">
            API
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3" href="api_docs">
            TensorFlow Core v2.1.0
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="4" href="api_docs/python/tf">
            Python
      
  </a>
</li>
</ul>
<devsite-page-rating hover-rating-star="0" position="header" selected-rating="0">
</devsite-page-rating>
</div>
<a class="dashingAutolink" name="autolink-1432"></a><a class="dashAnchor" name="//apple_ref/cpp/Function/tf.function"></a><h1 class="dash-function">tf.function</h1>
<devsite-toc class="devsite-nav" devsite-toc-embedded="">
</devsite-toc>
<div class="devsite-article-body clearfix">
<p></p>
<!-- DO NOT EDIT! Automatically generated file. -->
<div itemscope="" itemtype="http://developers.google.com/ReferenceObject">
<meta content="tf.function" itemprop="name"/>
<meta content="Stable" itemprop="path"/>
</div>
<p><devsite-nav-buttons name="version" param="reset">
<button default="" value="stable">See Stable</button>
<button value="nightly">See Nightly</button>
</devsite-nav-buttons></p>
<!-- Stable -->
<table align="left" class="tfo-notebook-buttons tfo-api">
<tbody><tr><td>
<a href="versions/r1.15/api_docs/python/tf/function" target="_blank">
<img src="https://www.tensorflow.org/images/tf_logo_32px.png"/>
  TensorFlow 1 version</a>
</td>
<td>
<a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/eager/def_function.py#L953-L1204" target="_blank">
<img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png"/>
    View source on GitHub
  </a>
</td></tr></tbody></table>
<p>Compiles a function into a callable TensorFlow graph.</p>
<section class="expandable">
<h4 class="showalways">View aliases</h4>
<p>
<b>Compat aliases for migration</b>
</p><p>See
<a href="https://www.tensorflow.org/guide/migrate">Migration guide</a> for
more details.</p>
<p><a href="api_docs/python/tf/function"><code dir="ltr" translate="no">tf.compat.v1.function</code></a></p>
</section>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.function(
    func=None, input_signature=None, autograph=True, experimental_implements=None,
    experimental_autograph_options=None, experimental_relax_shapes=False,
    experimental_compile=None
)
</code></pre>
<h3>Used in the notebooks</h3>
<table class="vertical-rules">
<thead>
<tr>
<th>Used in the guide</th>
<th>Used in the tutorials</th>
</tr>
</thead>
<tbody>
<tr>
<td>
<ul>
<li><a href="https://www.tensorflow.org/guide/concrete_function">Concrete functions</a></li>
<li><a href="https://www.tensorflow.org/guide/saved_model">Using the SavedModel format</a></li>
<li><a href="https://www.tensorflow.org/guide/function">Better performance with tf.function and AutoGraph</a></li>
</ul>
</td>
<td>
<ul>
<li><a href="https://www.tensorflow.org/tutorials/generative/deepdream">DeepDream</a></li>
<li><a href="https://www.tensorflow.org/tutorials/generative/style_transfer">Neural style transfer</a></li>
<li><a href="https://www.tensorflow.org/tutorials/customization/performance">Better performance with tf.function</a></li>
<li><a href="https://www.tensorflow.org/tutorials/generative/pix2pix">Pix2Pix</a></li>
<li><a href="https://www.tensorflow.org/tutorials/text/transformer">Transformer model for language understanding</a></li>
</ul>
</td>
</tr>
</tbody>
</table>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> constructs a callable that executes a TensorFlow graph
(<a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code dir="ltr" translate="no">tf.Graph</code></a>) created by trace-compiling the TensorFlow operations in <code dir="ltr" translate="no">func</code>,
effectively executing <code dir="ltr" translate="no">func</code> as a TensorFlow graph.</p>
<h4 id="example_usage_2">Example usage:</h4>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x, y): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return x ** 2 + y </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">x = tf.constant([2, 3]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">y = tf.constant([3, -2]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f(x, y) </code>
<code class="no-select nocode" dir="ltr" translate="no">&lt;tf.Tensor: ... numpy=array([7, 7], ...)&gt; </code>
</pre>
<p><em>Features</em></p>
<p><code dir="ltr" translate="no">func</code> may use data-dependent control flow, including <code dir="ltr" translate="no">if</code>, <code dir="ltr" translate="no">for</code>, <code dir="ltr" translate="no">while</code>
<code dir="ltr" translate="no">break</code>, <code dir="ltr" translate="no">continue</code> and <code dir="ltr" translate="no">return</code> statements:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  if tf.reduce_sum(x) &gt; 0: </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    return x * x </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  else: </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    return -x // 2 </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f(tf.constant(-2)) </code>
<code class="no-select nocode" dir="ltr" translate="no">&lt;tf.Tensor: ... numpy=1&gt; </code>
</pre>
<p><code dir="ltr" translate="no">func</code>&#39;s closure may include <a href="https://www.tensorflow.org/api_docs/python/tf/Tensor"><code dir="ltr" translate="no">tf.Tensor</code></a> and <a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code dir="ltr" translate="no">tf.Variable</code></a> objects:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return x ** 2 + y </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">x = tf.constant([-2, -3]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">y = tf.Variable([3, -2]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f() </code>
<code class="no-select nocode" dir="ltr" translate="no">&lt;tf.Tensor: ... numpy=array([7, 7], ...)&gt; </code>
</pre>
<p><code dir="ltr" translate="no">func</code> may also use ops with side effects, such as <a href="https://www.tensorflow.org/api_docs/python/tf/print"><code dir="ltr" translate="no">tf.print</code></a>, <a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code dir="ltr" translate="no">tf.Variable</code></a>
and others:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">v = tf.Variable(1) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  for i in tf.range(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    v.assign_add(i) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f(3) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">v </code>
<code class="no-select nocode" dir="ltr" translate="no">&lt;tf.Variable ... numpy=4&gt; </code>
</pre>
<aside class="special"><strong>Important:</strong><span> Any Python side-effects (appending to a list, printing with
<code dir="ltr" translate="no">print</code>, etc) will only happen once, when <code dir="ltr" translate="no">func</code> is traced. To have
side-effects executed into your <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> they need to be written
as TF ops:</span></aside>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">l = [] </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  for i in x: </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    l.append(i + 1)    # Caution! Will only happen once when tracing </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f(tf.constant([1, 2, 3])) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">l </code>
<code class="no-select nocode" dir="ltr" translate="no">[&lt;tf.Tensor ...&gt;] </code>
</pre>
<p>Instead, use TensorFlow collections like <a href="https://www.tensorflow.org/api_docs/python/tf/TensorArray"><code dir="ltr" translate="no">tf.TensorArray</code></a>:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  ta = tf.TensorArray(dtype=tf.int32, size=0, dynamic_size=True) </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  for i in range(len(x)): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    ta = ta.write(i, x[i] + 1) </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return ta.stack() </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f(tf.constant([1, 2, 3])) </code>
<code class="no-select nocode" dir="ltr" translate="no">&lt;tf.Tensor: ..., numpy=array([2, 3, 4], ...)&gt; </code>
</pre>
<p><em><a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> is polymorphic</em></p>
<p>Internally, <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> can build more than one graph, to support arguments
with different data types or shapes, since TensorFlow can build more
efficient graphs that are specialized on shapes and dtypes. <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a>
also treats any pure Python value as opaque objects, and builds a separate
graph for each set of Python arguments that it encounters.</p>
<p>To obtain an individual graph, use the <code dir="ltr" translate="no">get_concrete_function</code> method of
the callable created by <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a>. It can be called with the same
arguments as <code dir="ltr" translate="no">func</code> and returns a special <a href="https://www.tensorflow.org/api_docs/python/tf/Graph"><code dir="ltr" translate="no">tf.Graph</code></a> object:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return x + 1 </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">isinstance(f.get_concrete_function(1).graph, tf.Graph) </code>
<code class="no-select nocode" dir="ltr" translate="no">True </code>
</pre>
<aside class="caution"><strong>Caution:</strong><span> Passing python scalars or lists as arguments to <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> will
always build a new graph. To avoid this, pass numeric arguments as Tensors
whenever possible:</span></aside>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return tf.abs(x) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f1 = f.get_concrete_function(1) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f2 = f.get_concrete_function(2)  # Slow - builds new graph </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f1 is f2 </code>
<code class="no-select nocode" dir="ltr" translate="no">False </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f1 = f.get_concrete_function(tf.constant(1)) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f2 = f.get_concrete_function(tf.constant(2))  # Fast - reuses f1 </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f1 is f2 </code>
<code class="no-select nocode" dir="ltr" translate="no">True </code>
</pre>
<p>Python numerical arguments should only be used when they take few distinct
values, such as hyperparameters like the number of layers in a neural network.</p>
<p><em>Input signatures</em></p>
<p>For Tensor arguments, <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> instantiates a separate graph for every
unique set of input shapes and datatypes. The example below creates two
separate graphs, each specialized to a different shape:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return x + 1 </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">vector = tf.constant([1.0, 1.0]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">matrix = tf.constant([[3.0]]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f.get_concrete_function(vector) is f.get_concrete_function(matrix) </code>
<code class="no-select nocode" dir="ltr" translate="no">False </code>
</pre>
<p>An &#34;input signature&#34; can be optionally provided to <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> to control
the graphs traced. The input signature specifies the shape and type of each
Tensor argument to the function using a <a href="https://www.tensorflow.org/api_docs/python/tf/TensorSpec"><code dir="ltr" translate="no">tf.TensorSpec</code></a> object. More general
shapes can be used. This is useful to avoid creating multiple graphs when
Tensors have dynamic shapes. It also restricts the dhape and datatype of
Tensors that can be used:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">@tf.function( </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    input_signature=[tf.TensorSpec(shape=None, dtype=tf.float32)]) </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">def f(x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  return x + 1 </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">vector = tf.constant([1.0, 1.0]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">matrix = tf.constant([[3.0]]) </code>
<code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">f.get_concrete_function(vector) is f.get_concrete_function(matrix) </code>
<code class="no-select nocode" dir="ltr" translate="no">True </code>
</pre>
<p><em>Variables may only be created once</em></p>
<p><a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> only allows creating new <a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code dir="ltr" translate="no">tf.Variable</code></a> objects when it is called
for the first time:</p>
<pre class="devsite-click-to-copy prettyprint lang-py" dir="ltr" translate="no"><code class="devsite-terminal" data-terminal-prefix="&gt;&gt;&gt;" dir="ltr" translate="no">class MyModule(tf.Module): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  def __init__(self): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    self.v = None </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no"> </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  @tf.function </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">  def call(self, x): </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    if self.v is None: </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">      self.v = tf.Variable(tf.ones_like(x)) </code>
<code class="devsite-terminal" data-terminal-prefix="..." dir="ltr" translate="no">    return self.v * x </code>
</pre>
<p>In general, it is recommended to create stateful objects like <a href="https://www.tensorflow.org/api_docs/python/tf/Variable"><code dir="ltr" translate="no">tf.Variable</code></a>
outside of <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> and passing them as arguments.</p>
<h4 id="args_2">Args:</h4>
<ul>
<li><b><code dir="ltr" translate="no">func</code></b>: the function to be compiled. If <code dir="ltr" translate="no">func</code> is None, <a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function</code></a> returns
a decorator that can be invoked with a single argument - <code dir="ltr" translate="no">func</code>. In other
words, <code dir="ltr" translate="no">tf.function(input_signature=...)(func)</code> is equivalent to
<a href="https://www.tensorflow.org/api_docs/python/tf/function"><code dir="ltr" translate="no">tf.function(func, input_signature=...)</code></a>. The former can be used as
decorator.</li>
<li><b><code dir="ltr" translate="no">input_signature</code></b>: A possibly nested sequence of <a href="https://www.tensorflow.org/api_docs/python/tf/TensorSpec"><code dir="ltr" translate="no">tf.TensorSpec</code></a> objects
specifying the shapes and dtypes of the Tensors that will be supplied to
this function. If <code dir="ltr" translate="no">None</code>, a separate function is instantiated for each
inferred input signature.  If input_signature is specified, every input to
<code dir="ltr" translate="no">func</code> must be a <code dir="ltr" translate="no">Tensor</code>, and <code dir="ltr" translate="no">func</code> cannot accept <code dir="ltr" translate="no">**kwargs</code>.</li>
<li><b><code dir="ltr" translate="no">autograph</code></b>: Whether autograph should be applied on <code dir="ltr" translate="no">func</code> before tracing a
graph. Data-dependent control flow requires <code dir="ltr" translate="no">autograph=True</code>. For more
information, see the <a href="https://www.tensorflow.org/guide/function">tf.function and AutoGraph guide</a>.</li>
<li><b><code dir="ltr" translate="no">experimental_implements</code></b>: If provided, contains a name of a &#34;known&#34; function
this implements. For example &#34;mycompany.my_recurrent_cell&#34;.
This is stored as an attribute in inference function,
which can then be detected when processing serialized function.
See
https://github.com/tensorflow/community/blob/master/rfcs/20190610-standardizing-composite_ops.md
for details.  For an example of utilizing this attribute see:
https://github.com/tensorflow/tensorflow/blob/master/tensorflow/compiler/mlir/lite/transforms/prepare_composite_functions_tf.cc
The code above automatically detects and substitutes function that
implements &#34;embedded_matmul&#34; and allows TFLite to substitute its own
implementations. For instance, a tensorflow user can use this
attribute to mark that their function also implements
<code dir="ltr" translate="no">embedded_matmul</code>`` (perhaps more efficiently!)
by specifying it using this flag.</li>
</ul>
<blockquote>
<pre class="prettyprint" dir="ltr" translate="no"><code dir="ltr" translate="no">@tf.function(experimental_implements=&#34;embedded_matmul&#34;):
def embedding_matmul(a, b):
   # custom implementation here
</code></pre></blockquote>
<ul>
<li><b><code dir="ltr" translate="no">experimental_autograph_options</code></b>: Optional tuple of
<code dir="ltr" translate="no">tf.autograph.experimental.Feature</code> values.</li>
<li><b><code dir="ltr" translate="no">experimental_relax_shapes</code></b>: When True, <code dir="ltr" translate="no">tf.function</code> may generate fewer,
graphs that are less specialized on input shapes.</li>
<li><b><code dir="ltr" translate="no">experimental_compile</code></b>: If True, the function is always compiled by
<a href="https://www.tensorflow.org/xla">XLA</a>. XLA may be more efficient in some
cases (e.g. TPU, XLA_GPU, dense tensor computations).</li>
</ul>
<h4 id="returns_2">Returns:</h4>
<p>If <code dir="ltr" translate="no">func</code> is not None, returns a callable that will execute the compiled
function (and return zero or more <code dir="ltr" translate="no">tf.Tensor</code> objects).
If <code dir="ltr" translate="no">func</code> is None, returns a decorator that, when invoked with a single
<code dir="ltr" translate="no">func</code> argument, returns a callable equivalent to the case above.</p>
</div>
<devsite-page-rating hover-rating-star="0" position="footer" selected-rating="0">
</devsite-page-rating>
</article>
</article>

</devsite-content>
</main>
<devsite-footer-promos class="devsite-footer">
</devsite-footer-promos>
<devsite-footer-linkboxes class="devsite-footer">

</devsite-footer-linkboxes>
<devsite-footer-utility class="devsite-footer">
<div class="devsite-footer-utility nocontent">

</div>
</devsite-footer-utility>
</section></section>
<devsite-sitemask></devsite-sitemask>
<devsite-snackbar></devsite-snackbar> <devsite-tooltip></devsite-tooltip>
<devsite-heading-link></devsite-heading-link>
<devsite-analytics>


</devsite-analytics>
 
</body></html>