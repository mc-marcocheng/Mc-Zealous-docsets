<!DOCTYPE html><html dir="ltr" lang="en"><head>
<meta content="157101835696-ooapojlodmuabs2do2vuhhnf90bccmoi.apps.googleusercontent.com" name="google-signin-client-id"/>
<meta content="profile email" name="google-signin-scope"/>
<meta content="TensorFlow" property="og:site_name"/>
<meta content="website" property="og:type"/>
<meta content="#ff6f00" name="theme-color"/>
<meta charset="utf-8"/>
<meta content="IE=Edge" http-equiv="X-UA-Compatible"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<link crossorigin="use-credentials" href="_pwa/tensorflow/manifest.json" rel="manifest"/>
<link crossorigin="" href="/www.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.gstatic.com" rel="preconnect"/>
<link crossorigin="" href="/fonts.googleapis.com" rel="preconnect"/>
<link href="../../../../../../main.css" rel="stylesheet"/>

<noscript>

</noscript>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/favicon.png" rel="shortcut icon"/>
<link href="https://www.gstatic.com/devrel-devsite/prod/v3e2dbdc40e7394635e5230ecc02cb28039ea55a5d72db9939d2fb9fc9e16d0ff/tensorflow/images/apple-touch-icon-180x180.png" rel="apple-touch-icon"/><link href="https://www.tensorflow.org/api_docs/python/tf/compat/v1/nn/dynamic_rnn" rel="canonical"/><link href="https://www.tensorflow.org/s/opensearch.xml" rel="search" title="TensorFlow" type="application/opensearchdescription+xml"/>
<title>tf.compat.v1.nn.dynamic_rnn &nbsp;|&nbsp; TensorFlow Core v2.1.0</title>
<meta content="tf.compat.v1.nn.dynamic_rnn &nbsp;|&nbsp; TensorFlow Core v2.1.0" property="og:title"/>
<meta content="https://www.tensorflow.org/api_docs/python/tf/compat/v1/nn/dynamic_rnn" property="og:url"/>
<meta content="en" property="og:locale"/>

</head>
<body class="" layout="docs" pending="" theme="tensorflow-theme" type="reference">
<devsite-progress id="app-progress" type="indeterminate"></devsite-progress>
<section class="devsite-wrapper"> <devsite-book-nav scrollbars="">

</devsite-book-nav>
<section id="gc-wrapper">
<main class="devsite-main-content" has-book-nav="" has-toc="" role="main">
<devsite-toc class="devsite-nav"></devsite-toc>
<devsite-content>
<article class="devsite-article">
<article class="devsite-article-inner"><style>
        /* Styles inlined from /site-assets/css/style.css */
/* override theme */
table img {
  max-width: 100%;
}

/* override var element to differentiate color from comment */
var, var code, var span, .prettyprint var span {
  color: #039be5;
}

/* .devsite-terminal virtualenv prompt */
.tfo-terminal-venv::before {
  content: "(venv) $ " !important;
}

/* .devsite-terminal root prompt */
.tfo-terminal-root::before {
  content: "# " !important;
}

/* .devsite-terminal Windows prompt */
.tfo-terminal-windows::before {
  content: "C:\\> " !important;
}

/* .devsite-terminal Windows prompt w/ virtualenv */
.tfo-terminal-windows-venv::before {
  content: "(venv) C:\\> " !important;
}

.tfo-diff-green-one-level + * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green + * > * {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-green-list + ul > li:first-of-type {
  background: rgba(175, 245, 162, .6)  !important;
}

.tfo-diff-red-one-level + * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red + * > * {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

.tfo-diff-red-list + ul > li:first-of-type {
  background: rgba(255, 230, 230, .6)  !important;
  text-decoration: line-through  !important;
}

devsite-code .tfo-notebook-code-cell-output {
  max-height: 300px;
  overflow: auto;
  background: rgba(255, 247, 237, 1);  /* orange bg to distinguish from input code cells */
}

devsite-code .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(255, 247, 237, .7);  /* orange bg to distinguish from input code cells */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output {
  background: rgba(64, 78, 103, 1);  /* medium slate */
}

devsite-code[dark-code] .tfo-notebook-code-cell-output + .devsite-code-buttons-container button {
  background: rgba(64, 78, 103, .7);  /* medium slate */
}

/* override default table styles for notebook buttons */
.devsite-table-wrapper .tfo-notebook-buttons {
  display: inline-block;
  margin-left: 3px;
  width: auto;
}

.tfo-notebook-buttons td {
  padding-left: 0;
  padding-right: 20px;
}

.tfo-notebook-buttons a,
.tfo-notebook-buttons :link,
.tfo-notebook-buttons :visited {
  border-radius: 8px;
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 1px 3px 1px rgba(60, 64, 67, .15);
  color: #202124;
  padding: 12px 24px;
  transition: box-shadow 0.2s;
}

.tfo-notebook-buttons a:hover,
.tfo-notebook-buttons a:focus {
  box-shadow: 0 1px 2px 0 rgba(60, 64, 67, .3), 0 2px 6px 2px rgba(60, 64, 67, .15);
}

.tfo-notebook-buttons tr {
  background: 0;
  border: 0;
}

/* on rendered notebook page,
   remove link to webpage since we're already here */
.tfo-notebook-buttons:not(.tfo-api) td:first-child {
  display: none;
}

.tfo-notebook-buttons td > a {
  -webkit-box-align: center;
  -ms-flex-align: center;
  align-items: center;
  display: -webkit-box;
  display: -ms-flexbox;
  display: flex;
}

.tfo-notebook-buttons td > a > img {
  margin-right: 8px;
}

/* landing pages */

.tfo-landing-row-item-inset-white {
  background-color: #fff;
  padding: 32px;
}

.tfo-landing-row-item-inset-white ol,
.tfo-landing-row-item-inset-white ul {
  padding-left: 20px;
}

/* colab callout button */
.colab-callout-row devsite-code {
  border-radius: 8px 8px 0 0;
  box-shadow: none;
}

.colab-callout-footer {
  background: #e3e4e7;
  border-radius: 0 0 8px 8px;
  color: #37474f;
  padding: 20px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer {
  background: #3f4f66;
}


.colab-callout-footer > .button {
  margin-top: 4px;
  color: #ff5c00;
}

.colab-callout-footer > a > span {
  padding-top: 10px;
  vertical-align: middle;
  color: #37474f;
  padding-left: 10px;
  padding-right: 10px;
  font-size: 14px;
}

.colab-callout-row devsite-code[dark-code] + .colab-callout-footer > a > span {
  color: #fff;
}

a.colab-button {
  background: rgba(255, 255, 255, .75);
  border: solid 1px rgba(0, 0, 0, .08);
  border-bottom-color: rgba(0, 0, 0, .15);
  border-radius: 4px;
  color: #aaa;
  display: inline-block;
  font-size: 11px !important;
  font-weight: 300;
  line-height: 16px;
  padding: 4px 8px;
  text-decoration: none;
  text-transform: uppercase;
}

a.colab-button:hover {
  background: white;
  border-color: rgba(0, 0, 0, .2);
  color: #666;
}

a.colab-button span {
  background: url(/images/colab_logo_button.svg) no-repeat 1px 1px / 20px;
  border-radius: 4px;
  display: inline-block;
  padding-left: 24px;
  text-decoration: none;
}

@media screen and (max-width: 600px) {
  .tfo-notebook-buttons td {
    display: block;
  }
}

/* guide and tutorials landing page cards and sections */

.tfo-landing-page-card {
  padding: 16px;
  box-shadow: 0 0 36px rgba(0,0,0,0.1);
  border-radius: 10px;
}

/* Page section headings */
.tfo-landing-page-heading h2, h2.tfo-landing-page-heading {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 30px;
  font-weight: 700;
  line-height: 40px;
}

/* Item title headings */
.tfo-landing-page-heading h3, h3.tfo-landing-page-heading,
.tfo-landing-page-card h3, h3.tfo-landing-page-card {
  font-family: "Google Sans", sans-serif;
  color: #425066;
  font-size: 20px;
  font-weight: 500;
  line-height: 26px;
}

/* List of tutorials notebooks for subsites */
.tfo-landing-page-resources-ul {
  padding-left: 15px
}

.tfo-landing-page-resources-ul > li {
  margin: 6px 0;
}

/* Temporary fix to hide product description in header on landing pages */
devsite-header .devsite-product-description {
  display: none;
}

        </style> <div class="devsite-banner devsite-banner-announcement">
<div class="devsite-banner-message">
<div class="devsite-banner-message-text">
            Missed TensorFlow Dev Summit? Check out the video playlist. <a class="button button-primary button-tfo-announcement" href="https://goo.gle/TFDS20AllSessions">Watch recordings</a>
</div>
</div>
</div>
<div class="devsite-article-meta">
<ul class="devsite-breadcrumb-list">
<li class="devsite-breadcrumb-item">
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="1" href="">
            TensorFlow
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="2" href="api">
            API
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="3" href="api_docs">
            TensorFlow Core v2.1.0
      
  </a>
</li>
<li class="devsite-breadcrumb-item">
<div aria-hidden="true" class="devsite-breadcrumb-guillemet material-icons"></div>
<a class="devsite-breadcrumb-link gc-analytics-event" data-category="Site-Wide Custom Events" data-label="Breadcrumbs" data-value="4" href="api_docs/python/tf">
            Python
      
  </a>
</li>
</ul>
<devsite-page-rating hover-rating-star="0" position="header" selected-rating="0">
</devsite-page-rating>
</div>
<a class="dashingAutolink" name="autolink-799"></a><a class="dashAnchor" name="//apple_ref/cpp/Function/tf.compat.v1.nn.dynamic_rnn"></a><h1 class="dash-function">tf.compat.v1.nn.dynamic_rnn</h1>
<devsite-toc class="devsite-nav" devsite-toc-embedded="">
</devsite-toc>
<div class="devsite-article-body clearfix">
<p></p>
<!-- DO NOT EDIT! Automatically generated file. -->
<div itemscope="" itemtype="http://developers.google.com/ReferenceObject">
<meta content="tf.compat.v1.nn.dynamic_rnn" itemprop="name"/>
<meta content="Stable" itemprop="path"/>
</div>
<!-- Insert buttons and diff -->
<table align="left" class="tfo-notebook-buttons tfo-api">
<tbody><tr><td>
<a href="https://github.com/tensorflow/tensorflow/blob/v2.1.0/tensorflow/python/ops/rnn.py#L517-L716" target="_blank">
<img src="https://www.tensorflow.org/images/GitHub-Mark-32px.png"/>
    View source on GitHub
  </a>
</td></tr></tbody></table>
<p>Creates a recurrent neural network specified by RNNCell <code dir="ltr" translate="no">cell</code>. (deprecated)</p>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no">tf.compat.v1.nn.dynamic_rnn(
    cell, inputs, sequence_length=None, initial_state=None, dtype=None,
    parallel_iterations=None, swap_memory=False, time_major=False, scope=None
)
</code></pre>
<!-- Placeholder for "Used in" -->
<aside class="warning"><strong>Warning:</strong><span> THIS FUNCTION IS DEPRECATED. It will be removed in a future version.
Instructions for updating:
Please use <a href="api_docs/python/tf/keras/layers/RNN"><code dir="ltr" translate="no">keras.layers.RNN(cell)</code></a>, which is equivalent to this API</span></aside>
<p>Performs fully dynamic unrolling of <code dir="ltr" translate="no">inputs</code>.</p>
<h4 id="example">Example:</h4>
<pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no"># create a BasicRNNCell
rnn_cell = tf.compat.v1.nn.rnn_cell.BasicRNNCell(hidden_size)

# &#39;outputs&#39; is a tensor of shape [batch_size, max_time, cell_state_size]

# defining initial state
initial_state = rnn_cell.zero_state(batch_size, dtype=tf.float32)

# &#39;state&#39; is a tensor of shape [batch_size, cell_state_size]
outputs, state = tf.compat.v1.nn.dynamic_rnn(rnn_cell, input_data,
                                   initial_state=initial_state,
                                   dtype=tf.float32)
</code></pre><pre class="prettyprint lang-python" dir="ltr" translate="no"><code dir="ltr" translate="no"># create 2 LSTMCells
rnn_layers = [tf.compat.v1.nn.rnn_cell.LSTMCell(size) for size in [128, 256]]

# create a RNN cell composed sequentially of a number of RNNCells
multi_rnn_cell = tf.compat.v1.nn.rnn_cell.MultiRNNCell(rnn_layers)

# &#39;outputs&#39; is a tensor of shape [batch_size, max_time, 256]
# &#39;state&#39; is a N-tuple where N is the number of LSTMCells containing a
# tf.nn.rnn_cell.LSTMStateTuple for each cell
outputs, state = tf.compat.v1.nn.dynamic_rnn(cell=multi_rnn_cell,
                                   inputs=data,
                                   dtype=tf.float32)
</code></pre>
<h4 id="args">Args:</h4>
<ul>
<li><b><code dir="ltr" translate="no">cell</code></b>: An instance of RNNCell.</li>
<li><b><code dir="ltr" translate="no">inputs</code></b>: The RNN inputs.
If <code dir="ltr" translate="no">time_major == False</code> (default), this must be a <code dir="ltr" translate="no">Tensor</code> of shape:
<code dir="ltr" translate="no">[batch_size, max_time, ...]</code>, or a nested tuple of such elements.
If <code dir="ltr" translate="no">time_major == True</code>, this must be a <code dir="ltr" translate="no">Tensor</code> of shape: <code dir="ltr" translate="no">[max_time,
batch_size, ...]</code>, or a nested tuple of such elements. This may also be
a (possibly nested) tuple of Tensors satisfying this property.  The
first two dimensions must match across all the inputs, but otherwise the
ranks and other shape components may differ. In this case, input to
<code dir="ltr" translate="no">cell</code> at each time-step will replicate the structure of these tuples,
except for the time dimension (from which the time is taken). The input
to <code dir="ltr" translate="no">cell</code> at each time step will be a <code dir="ltr" translate="no">Tensor</code> or (possibly nested)
tuple of Tensors each with dimensions <code dir="ltr" translate="no">[batch_size, ...]</code>.</li>
<li><b><code dir="ltr" translate="no">sequence_length</code></b>: (optional) An int32/int64 vector sized <code dir="ltr" translate="no">[batch_size]</code>. Used
to copy-through state and zero-out outputs when past a batch element&#39;s
sequence length.  This parameter enables users to extract the last valid
state and properly padded outputs, so it is provided for correctness.</li>
<li><b><code dir="ltr" translate="no">initial_state</code></b>: (optional) An initial state for the RNN. If <code dir="ltr" translate="no">cell.state_size</code>
is an integer, this must be a <code dir="ltr" translate="no">Tensor</code> of appropriate type and shape
<code dir="ltr" translate="no">[batch_size, cell.state_size]</code>. If <code dir="ltr" translate="no">cell.state_size</code> is a tuple, this
should be a tuple of tensors having shapes <code dir="ltr" translate="no">[batch_size, s] for s in
cell.state_size</code>.</li>
<li><b><code dir="ltr" translate="no">dtype</code></b>: (optional) The data type for the initial state and expected output.
Required if initial_state is not provided or RNN state has a heterogeneous
dtype.</li>
<li><b><code dir="ltr" translate="no">parallel_iterations</code></b>: (Default: 32).  The number of iterations to run in
parallel.  Those operations which do not have any temporal dependency and
can be run in parallel, will be.  This parameter trades off time for
space.  Values &gt;&gt; 1 use more memory but take less time, while smaller
values use less memory but computations take longer.</li>
<li><b><code dir="ltr" translate="no">swap_memory</code></b>: Transparently swap the tensors produced in forward inference
but needed for back prop from GPU to CPU.  This allows training RNNs which
would typically not fit on a single GPU, with very minimal (or no)
performance penalty.</li>
<li><b><code dir="ltr" translate="no">time_major</code></b>: The shape format of the <code dir="ltr" translate="no">inputs</code> and <code dir="ltr" translate="no">outputs</code> Tensors. If true,
these <code dir="ltr" translate="no">Tensors</code> must be shaped <code dir="ltr" translate="no">[max_time, batch_size, depth]</code>. If false,
these <code dir="ltr" translate="no">Tensors</code> must be shaped <code dir="ltr" translate="no">[batch_size, max_time, depth]</code>. Using
<code dir="ltr" translate="no">time_major = True</code> is a bit more efficient because it avoids transposes
at the beginning and end of the RNN calculation.  However, most TensorFlow
data is batch-major, so by default this function accepts input and emits
output in batch-major form.</li>
<li><b><code dir="ltr" translate="no">scope</code></b>: VariableScope for the created subgraph; defaults to &#34;rnn&#34;.</li>
</ul>
<h4 id="returns">Returns:</h4>
<p>A pair (outputs, state) where:</p>
<ul>
<li><p><b><code dir="ltr" translate="no">outputs</code></b>: The RNN output <code dir="ltr" translate="no">Tensor</code>.</p>
<p>If time_major == False (default), this will be a <code dir="ltr" translate="no">Tensor</code> shaped:
<code dir="ltr" translate="no">[batch_size, max_time, cell.output_size]</code>.</p>
<p>If time_major == True, this will be a <code dir="ltr" translate="no">Tensor</code> shaped:
<code dir="ltr" translate="no">[max_time, batch_size, cell.output_size]</code>.</p>
<p>Note, if <code dir="ltr" translate="no">cell.output_size</code> is a (possibly nested) tuple of integers
or <code dir="ltr" translate="no">TensorShape</code> objects, then <code dir="ltr" translate="no">outputs</code> will be a tuple having the
same structure as <code dir="ltr" translate="no">cell.output_size</code>, containing Tensors having shapes
corresponding to the shape data in <code dir="ltr" translate="no">cell.output_size</code>.</p></li>
<li><p><b><code dir="ltr" translate="no">state</code></b>: The final state.  If <code dir="ltr" translate="no">cell.state_size</code> is an int, this
will be shaped <code dir="ltr" translate="no">[batch_size, cell.state_size]</code>.  If it is a
<code dir="ltr" translate="no">TensorShape</code>, this will be shaped <code dir="ltr" translate="no">[batch_size] + cell.state_size</code>.
If it is a (possibly nested) tuple of ints or <code dir="ltr" translate="no">TensorShape</code>, this will
be a tuple having the corresponding shapes. If cells are <code dir="ltr" translate="no">LSTMCells</code>
<code dir="ltr" translate="no">state</code> will be a tuple containing a <code dir="ltr" translate="no">LSTMStateTuple</code> for each cell.</p></li>
</ul>
<h4 id="raises">Raises:</h4>
<ul>
<li><b><code dir="ltr" translate="no">TypeError</code></b>: If <code dir="ltr" translate="no">cell</code> is not an instance of RNNCell.</li>
<li><b><code dir="ltr" translate="no">ValueError</code></b>: If inputs is None or an empty list.</li>
</ul>
</div>
<devsite-page-rating hover-rating-star="0" position="footer" selected-rating="0">
</devsite-page-rating>
</article>
</article>

</devsite-content>
</main>
<devsite-footer-promos class="devsite-footer">
</devsite-footer-promos>
<devsite-footer-linkboxes class="devsite-footer">

</devsite-footer-linkboxes>
<devsite-footer-utility class="devsite-footer">
<div class="devsite-footer-utility nocontent">

</div>
</devsite-footer-utility>
</section></section>
<devsite-sitemask></devsite-sitemask>
<devsite-snackbar></devsite-snackbar> <devsite-tooltip></devsite-tooltip>
<devsite-heading-link></devsite-heading-link>
<devsite-analytics>


</devsite-analytics>
 
</body></html>